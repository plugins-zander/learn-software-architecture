# 使用“4+1”模型描述软件体系结构

- 从1990年开始，Rational公司的Philippe Kruchten对软件体系结构的不同视角进行了专门的研究，并于1995年在IEEE提出了用于体系结构描述的“4+1”视图模型(The 4+1 View Model of Architecture)。

  - 逻辑视图(Logical View)

    - 当采用面向对象的设计方法时，逻辑视图即是对象模型。 

    - 逻辑视图主要支持功能需求——系统应当向用户提供什么样的服务。

    - 从问题域出发，采用面向对象的方法，按照抽象、封装、继承的原则进行分解，得到代表着系统的关键抽象表示的集合。

    - 这些抽象表示的具体形式就是对象和对象的类。

    - 这种分级不仅是为了功能分析，而且还担负着在系统的各部分中确定公共机制和设计元素的作用。

    - 除了面向对象的方法，还可以使用其他形式的逻辑体系结构。

      - 例如，当所面对的应用具有很明显的数据驱动的特征时，可以使用E-R图。

    - 逻辑视图的符号表示法

      - 逻辑体系结构的符号表示法(见图4-18)是从Booch方法派生而来的。

      - 它被极大地简化了，尤其大量简化了在这个设计阶段作用不大的各种修饰，只考虑对于体系结构有重要意义的元素。

      - 在设计工具上，可以使用Rational Rose等UML建模工具。公共的机制和服务在类设施(Class Utilities)中定义。

      - 图示

        - 

          ![img](https://mubu.com/document_image/e39cb60e-773e-4759-9bf7-f8dd86971de8-4644403.jpg)

    - 逻辑视图的风格

      - 逻辑视图也可以采用面向对象的风格。
      - 逻辑视图设计的主要准则是，要设法在整个系统中保持一个单一的、连贯的对象模型，避免类和相关机制按照场地或处理器过早地分化。

  - 过程视图(Process View)

    - 描述系统的并发和同步方面的设计。

    - 过程体系结构考虑的是一些非功能性的需求，诸如性能、可用性等。

    - 它所要面对的问题有并发、分布、系统的完整性、容错能力等。

    - 它还要考虑怎样把过程体系结构与逻辑视图体系结构的要点相适应——对某个对象的某个操作实际上是在哪个控制线程上发生的。

    - 过程视图的符号表示法

      - 这里介绍的过程体系结构符号表示法是从Booch为Ada任务分配提出的符号表示法扩展而来的。

      - 与逻辑视图的符号表示法类似，它也被极大地简化了，只考虑对于体系结构有重要意义的元素，如图4-20所示。

      - 图示

        - 

          ![img](https://mubu.com/document_image/c11e28d0-ec3e-4637-8150-4e9955c30051-4644403.jpg)

    - 过程视图的风格

      - 有多种风格适合过程体系结构。例如管道-过滤器、客户/服务器及其变体(多客户/单服务器、多客户/多服务器等)

  - 物理视图(Physical View)

    - 描述软件到硬件之间的映射关系，反映系统在分布方面的设计。

    - 物理视图的体系结构：从软件到硬件的映射

      - 物理体系结构主要考虑的是非功能性的系统需求，如系统的可用性、可靠性(容错性)、性能(信息吞吐量)和可扩展性。
      - 软件系统在计算机网络的各个处理节点上运行。
      - 各种被确定出的元素——网络、过程、任务和对象——需要映射到各种节点上去，将用到不同的物理配置，有些用于开发和测试，有些用于不同场所或不同用户。
      - 因此从软件到处理节点的映射需要高度灵活，并且最小限度地影响其本身的源代码。

    - 物理视图的符号表示法

      - 图示

        - 

          ![img](https://mubu.com/document_image/b8a2a08d-07f1-46e3-8311-fc4003bacf7a-4644403.jpg)

      - 大型系统中的物理视图可能非常凌乱

        - TRW公司的UNAS允许使用者采用数据驱动的方式将过程体系结构映射到物理体系结构，并允许在不修改源代码的情况下对这种映射做出多种改动。

  - 开发视图(Development View)

    - 描述软件在开发环境下的静态组织结构。

    - 开发视图的符号表示法

      - 与前面类似，开发视图的符号表示法采用Booch表示法的变体，并且只考虑对于体系结构有重要意义的元素

        - 图示

          - 

            ![img](https://mubu.com/document_image/4bd475ca-0776-4c49-9ab9-f64a99fbbd37-4644403.jpg)

      - Rational公司的Apex Development Environment 支持对开发视图的定义和实现，也支持上面描述的分层策略和对设计规则的执行。在Rational Rose中，可以绘制模块层和子系统层的开发体系结构图，还可以在逆向工程中从已经开发的源代码(Ada或C++)中得出系统的开发体系结构图。

    - 开发视图的风格

      - 对于开发视图，我们建议采用分层风格，定义4～6层的子系统。
      - 每一层都有明确定义的责任。
      - 设计规则是，某一层的子系统只能依赖于本层或其下层的子系统。
      - 这样做的目的是使模块间相互依赖而构成的复杂网络最小化，并使得系统可以采用逐层的策略完成释放。

  - 另外加上场景(Scenarios)

    - 场景视图的体系结构：汇总
      - 通过使用一些重要场景，4个视图中的元素可以协调地共同工作。
      - 尽管这些场景是一个小集合，但是它们很重要。
      - 场景是更通用的概念——用例的实例。
      - 从某种意义上讲，场景是最重要的需求的抽象。
      - 场景的设计使用对象场景图(Object Scenario Diagram)和对象交互图来表示。
    - 相对于其他的4个视图，场景视图是多余出来的(所以称为“4+1”)，但是它承担着两个任务
      - 在下面要讲到的体系结构设计中，将以此视图为驱动来发现体系结构元素。
      - 在体系结构设计结束后，此视图承担验证和描述的角色。它不仅用于书面记录，并且是体系结构原型测试的起始点。
    - 场景视图的符号表示法
      - 场景视图的符号表示法中，构件的表示与逻辑视图非常相似，但是连接件的表示使用过程视图中的方法。
      - 注意，对象的实例用细实线表示。
      - 在工具的使用方面，和逻辑体系结构类似，可以使用Rational Rose绘制和管理对象场景图。

  - 图示

    - 

      ![img](https://mubu.com/document_image/1c8ab502-5cf5-4f19-96b3-b9f2c4152a5d-4644403.jpg)

  - “4+1”视图模型为理解复杂系统的软件体系结构提供了一个简单和易于理解的方式。它从 5个不同的角度来描述软件，每个角度都显示了模型系统的一个具体方面。
# 解释器风格

解释器风格

- 特征

  - 基于解释器风格的系统核心在于虚拟机。
  - 一个基于解释器风格的系统通常包括：正在被解释执行的伪码和解释引擎
  - 伪码：由需要被解释执行的源代码和解释引擎分析所得的中间代码组成
  - 解释引擎包括：语法解释器和解释器当前的运行状态

- 图示

  - 

    ![img](https://mubu.com/document_image/e1402a71-f595-4323-a386-f327c4c0e3f6-4644403.jpg)

- 优点

  - 在文法规则比较简单的情况下，解释器风格工作的很好
  - 易于改变和扩展文法
    - 因为解释器风格使用类来表示文法规则，用户可以使用继承来改变和扩展文法。已有的表达式可以采用增量的方式逐渐扩充，而新的表达式可以定义为旧表达式的变体
  - 易于实现文法。
  - 可以用多种操作来“解释”一个句子。

- 缺点

  - 无法解释复杂的文法规则
    - 对于比较简单的文法规则，解释器风格工作的很好，而对于复杂的文法规则，则由于文法层次的庞大而难于管理
  - 应用范围比较狭窄
  - 在文法规则比较复杂，则文法的层次变得无法管理，系统中需要包含许多表示文法规则的类

- 解释器风格实例：一个布尔表达式解释器

  - 图示

    - 

      ![img](https://mubu.com/document_image/96fb3fd8-dd89-450c-9054-c738c90056bb-4644403.jpg)

      ![img](https://mubu.com/document_image/1f60ff83-bad6-4237-b3d8-ed3e41b6a8bb-4644403.jpg)

      ![img](https://mubu.com/document_image/275d6208-1a03-4a75-907f-921958462b3f-4644403.jpg)

      ![img](https://mubu.com/document_image/3b2c4995-3728-4229-9b7e-44a1f3437496-4644403.jpg)

      ![img](https://mubu.com/document_image/d3d238be-d5ad-484f-920d-c7114b11e9c0-4644403.jpg)

  - 优缺点

    - 在文法规则比较简单的情况下，解释器风格工作的很好，但如果文法规则复杂，则文法的层次变得庞大而无法管理，系统中需要包含许多表示文法规则的类。
    - 最高效的解释器通常不是通过直接解释语法分析数实现的，而是首先将它们转换成另一种形式。
    - 易于改变和扩展文法。
    - 易于实现文法。

  - 角色

    - BooleanExpression（抽象布尔表达式）
    - TerminalExpression（终结符表达式，如VariableExpresssion和Constant）
    - NonterminalExpression（非终结符表达式，如AndExpression、OrExpression和NotExpression）
    - Context（上下文，也就是“解释引擎内部状态”）
    - Client（客户）

  - 实现

    - 在具体实现布尔表达式求值系统时还有许多细节的问题要处理，这些细节问题处理的好坏甚至会直接影响整个系统的性能。这些问题主要表现在以下几个方面
      - 创建抽象语法树
      - 定义求值操作
      - 共享终结符

  -  
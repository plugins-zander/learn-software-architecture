# 分层风格

分层风格

- 特征

  - 一个分层系统采用层次化的组织方式构建，系统中的每一层都要承担两个角色。

    - 首先，它要为结构中的上层提供服务；
    - 其次，它要作为结构中下面层次的客户，调用下层提供的功能函数。

  - 图示

    - 

      ![img](https://mubu.com/document_image/88760002-430b-4162-9916-66e26860b91b-4644403.jpg)

- 优点

  - 分层风格支持系统设计过程中的逐级抽象
  - 基于分层风格的系统具有较好的可扩展性
  - 分层风格支持软件复用

- 缺点

  - 并不是所有的系统都适合用分层风格来描述的
  - 对于抽象出来的功能具体应该放在哪个层次上也是设计者头疼的一个问题

- 分层风格实例：计算机网络的设计

  - 概述

    - 网络协议设计者将计算机网络中的各个部分按其功能划分为若干个层次（Layer），其中的每一个层次都可以看成是一个相对独立的黑箱、一个封闭的系统。用户只关心每一层的外部特性，只需要定义每一层的输入、数据处理和输出等外部特性。

  - ISO/OSI网络体系结构

    - ISO/OSI采用了7层体系结构，从高到低分别是

      - 应用层
        - 它的主要功能是为数据提供各种可行的收发方式。
        - 它应该为网络用户或应用程序提供各种应用服务，如文件传输、电子邮件（E-mail）、分布式数据库、网络管理等。
        - 这类似于用户公司内部的部门或个人在收发货物时，都必须遵循用户公司内部的有关规定，只能使用用户公司所允许的方式来收发货物。
        - 从另一方面来说，用户公司也要为公司内部的部门或个人收发货物提供各种可行的收发方式，让用户公司内部的部门或个人知道他们能够使用哪些方式来收发货物。
      - 表示层
        - 它的主要功能是为数据提供收发、存放的具体格式和规范。
        - 它应该为应用层提供信息表示方式的服务，如数据格式的变换、文本压缩、加密技术等。
        - 这类似于用户公司的货物收发员，它负责与用户公司内部要收发货物的部门或个人打交道，在收集要发送的货物时告诉用户应该怎样填写发货资料，在向用户发放货物时告诉用户应该完清哪些具体手续，等等。 
      - 会话层
        - 它的主要功能是负责收发数据的交接工作、并组织和管理数据。
        - 它应该为表示层提供建立、维护和结束会话连接的功能，并提供会话管理服务。
        - 这类似于用户公司的货物收发室，它负责与运输公司打交道，完成用户公司货物的收发的交接工作、并组织管理公司内部要收发的货物。
      - 传输层
        - 它的主要功能是在上层和下层之间起到一种接口的功能。
        - 它应该为上层提供端到端（最终用户到最终用户）、的透明的、可靠的数据传输服务。
        - 所谓透明的传输是指在通信过程中上层可以将下面各层看作是一个封闭的黑箱系统，传输层对上层屏蔽了传输系统的具体细节。
        - 这类似于运输公司在各个地方设置的业务接洽处，它负责在用户和公司之间建立起一个货物交接的桥梁，使得用户不用去管运输公司将以什么样的方式将货物运送到目的地，也就是说业务接洽处对用户屏蔽了货物运输中的具体细节。 
      - 网络层
        - 它的主要功能是路由控制（找路）、拥塞控制和数据打包。
        - 它应该为其上一层传输层的数据传输提供建立、维护和终止网络连接的手段，把上层传来的数据分割成一个一个的数据包（Packet，也叫报文分组）在结点之间进行交换传送，并且负责路由控制和拥塞控制。
        - 这类似于运输公司需要将用户发送的货物进行分割打包，并在现有的交通网络之中负责找出一条从源地址到目的地址的线路（即找路），在找路时需要考虑到能否到达、拥塞状况、安全可靠性、甚至交通费用等诸多方面的因素。
      - 数据链路层
        - 它的主要功能是纠错和流量控制，负责在可能出现差错的物理线路中实现无差错的数据传送。它应该在物理层的基础上，建立相邻结点之间的数据链路，通过差错控制提供数据帧（Frame）的无差错传输，并进行数据流量控制。
        - 这类似于运输公司的运输管理和质量监督部门，需要负责在可能出现问题的运输线路之中保质保量地完成运输任务。
      - 物理层
        - 它负责在物理信道上传输原始的数据bit流。它应该提供为建立、维护和拆除物理链路连接所需的机械的、电气的、功能和规程的特性，这类似于运输车辆只需要负责将装在车辆内的货物（类似于bits）运送到某地就行了。
      - 层与层之间的联系是通过各层之间的接口来实现的，上层通过接口向下层提出服务请求，而下层通过接口向上层提供服务。两台计算机通过网络进行通信时，只有两物理层之间能够通过媒体进行真正的数据通信，其余各对等层之间均不存在直接的通信关系，各对等层之间只能通过各对等层的协议来进行虚拟通信。

    - 图示

      - 

        ![img](https://mubu.com/document_image/1e04e374-26b9-403d-83b4-6344bb9ad9a3-4644403.jpg)

  - ISO/OSI层次分组关系 :有两种分组方法

  - 从数据处理分工的角度

    - 将ISO/OSI七个层次分为三组
      - 第1、2层解决有关网络信道问题
      - 第3、4层解决传输服务问题
      - 第5、6、7层则处理对应用进程的访问

  - 从数据传输控制的角度

    - 将ISO/OSI七个层次分为三组
      - 下三层（1、2、3层）可以看作是传输控制组，负责通信子网的工作，解决网络中的通信问题
      - 上三层（5、6、7层）为应用控制组，负责有关资源子网的工作，解决应用进程之间的信息转换问题
      - 中间层（4层）则为通信子网和资源子网的接口，起到连接传输和应用的作用

- 分层风格实例：.Net平台

  - 

    ![img](https://mubu.com/document_image/439775f8-6643-4e43-9042-a005e641c7e6-4644403.jpg)

    ![img](https://mubu.com/document_image/b30cfedb-b34f-4d1f-a759-c66800d95c6f-4644403.jpg)